<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能工具中心</title>
    
    <!-- 外部资源引用 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <i class="fas fa-tools logo-icon"></i>
                <span class="logo-text">智能工具中心</span>
            </div>
            
            <button class="menu-toggle" onclick="toggleNavMenu()" aria-label="切换菜单">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-menu" id="navbarMenu">
                <div class="nav-search">
                    <input type="text" placeholder="搜索工具..." class="nav-search-input" id="resourceSearch">
                    <button class="nav-search-btn" onclick="searchResources()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                
                <ul class="nav-links">
                    <li><a href="#tools" class="nav-link"><i class="fas fa-tools"></i> 工具库</a></li>
                    <li><a href="#membership" class="nav-link"><i class="fas fa-crown"></i> 会员中心</a></li>
                    <li><a href="#about" class="nav-link"><i class="fas fa-info-circle"></i> 关于我们</a></li>
                </ul>
                
                <div class="nav-actions" id="userActions">
                    <button class="btn btn-outline" onclick="openLoginModal()">
                        <i class="fas fa-sign-in-alt"></i> 登录
                    </button>
                    <button class="btn btn-primary" onclick="openRegisterModal()">
                        <i class="fas fa-user-plus"></i> 注册
                    </button>
                </div>
                
                <div class="user-menu" id="userProfile" style="display: none;">
                    <div class="user-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="userName"></div>
                        <div class="user-level" id="userLevel"></div>
                    </div>
                    <div class="user-dropdown">
                        <i class="fas fa-chevron-down"></i>
                        <div class="dropdown-menu">
                        <a href="#userCenter"><i class="fas fa-user"></i> 个人中心</a>
                        <a href="#favorites" onclick="showFavorites()"><i class="fas fa-heart"></i> 我的收藏</a>
                        <a href="#settings"><i class="fas fa-cog"></i> 设置</a>
                        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> 退出登录</a>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 英雄区域 -->
    <header class="hero-section">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">
                    <span class="highlight">智能工具中心</span>
                    <br>您的一站式工具平台
                </h1>
                <p class="hero-subtitle">
                    提供丰富的在线工具，满足您的工作、学习和生活需求
                </p>
                <div class="hero-actions">
                    <button class="btn btn-large btn-primary" onclick="navigateToSection('tools')">
                        <i class="fas fa-tools"></i> 探索工具
                    </button>
                    <button class="btn btn-large btn-outline" onclick="navigateToSection('membership')">
                        <i class="fas fa-crown"></i> 会员特权
                    </button>
                </div>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-number">100+</div>
                        <div class="stat-label">工具数量</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">10k+</div>
                        <div class="stat-label">活跃用户</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">99.9%</div>
                        <div class="stat-label">服务可用性</div>
                    </div>
                </div>
            </div>
            <div class="hero-visual">
                <div class="visual-card">
                    <i class="fas fa-tools globe-icon"></i>
                    <div class="visual-circles">
                        <div class="circle circle-1"></div>
                        <div class="circle circle-2"></div>
                        <div class="circle circle-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 工具库区域 -->
    <section id="tools" class="tools-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">工具库</h2>
                <p class="section-subtitle">浏览和使用各类工具</p>
            </div>
            
            <!-- 工具筛选与搜索区域 -->
            <div class="resource-controls">
                <div class="resource-filters">
                    <button class="filter-btn active" data-filter="all">全部工具</button>
                    <button class="filter-btn" data-filter="converter">格式转换</button>
                    <button class="filter-btn" data-filter="calculator">计算器</button>
                    <button class="filter-btn" data-filter="generator">生成器</button>
                    <button class="filter-btn" data-filter="analyzer">分析工具</button>
                    <button class="filter-btn" data-filter="utilities">实用工具</button>
                </div>
                
                <div class="resource-search-container">
                    <input type="text" id="toolSearch" placeholder="搜索工具...">
                    <i class="fas fa-search"></i>
                </div>
                
                <div class="resource-sort">
                    <label for="sort">排序方式：</label>
                    <div class="sort-options">
                        <button class="sort-option active" data-sort="popular">
                            <i class="fas fa-star"></i> 最受欢迎
                        </button>
                        <button class="sort-option" data-sort="newest">
                            <i class="fas fa-clock"></i> 最新工具
                        </button>
                        <button class="sort-option" data-sort="name">
                            <i class="fas fa-sort-alpha-down"></i> 名称排序
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="resources-grid" id="toolsGrid">
                <!-- 工具卡片将通过JavaScript动态生成 -->
            </div>
        </div>
    </section>

    <!-- 收藏夹区域 -->
    <section id="favorites" class="favorites-section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">我的收藏</h2>
                <p class="section-subtitle">查看和管理您收藏的工具</p>
            </div>
            
            <div class="favorites-controls">
                <div class="favorites-search-container">
                    <input type="text" id="favoritesSearch" placeholder="搜索收藏的工具...">
                    <i class="fas fa-search"></i>
                </div>
                
                <div class="favorites-sort">
                    <label for="favoritesSort">排序方式：</label>
                    <div class="sort-options">
                        <button class="sort-option active" data-sort="newest">
                            <i class="fas fa-clock"></i> 最新收藏
                        </button>
                        <button class="sort-option" data-sort="name">
                            <i class="fas fa-sort-alpha-down"></i> 名称排序
                        </button>
                        <button class="sort-option" data-sort="popular">
                            <i class="fas fa-star"></i> 最受欢迎
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="favorites-empty" id="favoritesEmpty" style="display: block;">
                <div class="empty-state">
                    <i class="fas fa-heart-broken"></i>
                    <h3>您还没有收藏任何工具</h3>
                    <p>浏览工具库，点击心形图标收藏您感兴趣的工具</p>
                    <button class="btn btn-primary" onclick="showTools()">
                        <i class="fas fa-tools"></i> 浏览工具库
                    </button>
                </div>
            </div>
            
            <div class="resources-grid" id="favoritesGrid">
                <!-- 收藏的资源卡片将通过JavaScript动态生成 -->
            </div>
        </div>
    </section>

    <!-- 在线浏览器区域 -->
    <section id="browser" class="browser-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">在线浏览器</h2>
                <p class="section-subtitle">安全、快速的在线搜索体验</p>
            </div>
            
            <div class="browser-container">
                <div class="browser-toolbar">
                    <button class="browser-btn" onclick="browserSystem.browserBack()" title="后退">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="browser-btn" onclick="browserSystem.browserForward()" title="前进">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <button class="browser-btn" onclick="browserSystem.refreshBrowser()" title="刷新">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="browser-btn" onclick="browserSystem.browserHome()" title="主页">
                        <i class="fas fa-home"></i>
                    </button>
                    
                    <div class="browser-url-container">
                        <input type="text" id="browserUrl" placeholder="输入网址或搜索内容..." class="browser-url">
                        <button class="browser-go" onclick="browserSystem.navigate()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 浏览器标签页容器 -->
                <div id="browserTabs" class="browser-tabs"></div>
                
                <div class="browser-content">
                    <div id="iframeLoading" class="browser-loading">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">加载中...</div>
                    </div>
                    <div class="browser-iframe-container">
                        <iframe id="browserIframe" class="browser-iframe" src="about:blank" frameborder="0" sandbox="allow-scripts allow-popups allow-forms allow-top-navigation-by-user-activation"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 热门工具展示区域 -->
    <section id="showcase" class="showcase-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">热门工具</h2>
                <p class="section-subtitle">发现最受欢迎的日常工具</p>
            </div>
            
            <div class="showcase-grid">
                <!-- 热门工具卡片 -->
                <div class="showcase-card" onclick="openTool('text-to-speech')">
                    <div class="showcase-icon">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <h3 class="showcase-title">文字转语音</h3>
                    <p class="showcase-description">将文字转换为自然语音</p>
                </div>
                <div class="showcase-card" onclick="openTool('calculator')">
                    <div class="showcase-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3 class="showcase-title">智能计算器</h3>
                    <p class="showcase-description">强大的多功能计算器</p>
                </div>
                <div class="showcase-card" onclick="openTool('unit-converter')">
                    <div class="showcase-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <h3 class="showcase-title">单位转换</h3>
                    <p class="showcase-description">快速转换各种单位</p>
                </div>
                <div class="showcase-card" onclick="openTool('password-generator')">
                    <div class="showcase-icon">
                        <i class="fas fa-key"></i>
                    </div>
                    <h3 class="showcase-title">密码生成</h3>
                    <p class="showcase-description">生成安全复杂的密码</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="footer-section">
        <div class="container">
            <div class="footer-content">
                <div class="footer-about">
                    <div class="footer-logo">
                        <i class="fas fa-tools"></i>
                        <span>智能工具中心</span>
                    </div>
                    <p>一站式在线工具平台，为用户提供丰富、高效的工具服务</p>
                </div>
                
                <div class="footer-links">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="#tools">工具库</a></li>
                        <li><a href="#browser">在线浏览器</a></li>
                        <li><a href="#upload">上传工具</a></li>
                        <li><a href="#userCenter">个人中心</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h4>联系我们</h4>
                    <ul>
                        <li><i class="fas fa-envelope"></i> contact@downloadsite.com</li>
                        <li><i class="fas fa-phone"></i> 400-123-4567</li>
                        <li><i class="fas fa-map-marker-alt"></i> 北京市朝阳区科技园区</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-copyright">
                    &copy; 2023 智能工具中心. 保留所有权利.
                </div>
                <div class="footer-social">
                    <a href="#"><i class="fab fa-weixin"></i></a>
                    <a href="#"><i class="fab fa-weibo"></i></a>
                    <a href="#"><i class="fab fa-qq"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- 登录模态框 -->
    <div class="modal" id="loginModal">
        <div class="modal-overlay" onclick="closeModal('loginModal')"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户登录</h3>
                <button class="modal-close" onclick="closeModal('loginModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="loginForm" class="modal-form">
                <div class="form-group">
                    <label for="loginUsername">用户名</label>
                    <input type="text" id="loginUsername" required>
                    <div id="loginUsernameError" class="error-message"></div>
                </div>
                <div class="form-group">
                    <label for="loginPassword">密码</label>
                    <div class="password-input">
                        <input type="password" id="loginPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-options">
                    <label class="checkbox">
                        <input type="checkbox"> 记住密码
                    </label>
                    <a href="#">忘记密码？</a>
                </div>
                <button type="submit" class="btn btn-primary">登录</button>
            </form>
            <div class="modal-footer">
                <p>还没有账号？<a href="#" onclick="openRegisterModal(); closeModal('loginModal')">立即注册</a></p>
            </div>
        </div>
    </div>

    <!-- 注册模态框 -->
    <div class="modal" id="registerModal">
        <div class="modal-overlay" onclick="closeModal('registerModal')"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户注册</h3>
                <button class="modal-close" onclick="closeModal('registerModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="registerForm" class="modal-form">
                <div class="form-group">
                    <label for="registerUsername">用户名</label>
                    <input type="text" id="registerUsername" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">邮箱</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">密码</label>
                    <div class="password-input">
                        <input type="password" id="registerPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-strength" id="passwordStrength"></div>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">确认密码</label>
                    <div class="password-input">
                        <input type="password" id="confirmPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-match" id="passwordMatch"></div>
                </div>
                <div class="form-options">
                    <label class="checkbox">
                        <input type="checkbox" required> 我已阅读并同意<a href="#">用户协议</a>和<a href="#">隐私政策</a>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">注册</button>
            </form>
            <div class="modal-footer">
                <p>已有账号？<a href="#" onclick="openLoginModal(); closeModal('registerModal')">立即登录</a></p>
            </div>
        </div>
    </div>

    <!-- 资源详情模态框 -->
    <div class="modal" id="resourceModal">
        <div class="modal-overlay" onclick="closeModal('resourceModal')"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>资源详情</h3>
                <button class="modal-close" onclick="closeModal('resourceModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="resource-details" id="resourceDetails">
                <!-- 资源详情将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>
    
    <!-- 反馈模态框 -->
    <div class="modal" id="feedbackModal">
        <div class="modal-overlay" onclick="closeModal('feedbackModal')"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户反馈</h3>
                <button class="modal-close" onclick="closeModal('feedbackModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="feedbackForm">
                    <div class="form-group">
                        <label for="feedbackType">反馈类型</label>
                        <select id="feedbackType" required>
                            <option value="">请选择反馈类型</option>
                            <option value="suggestion">功能建议</option>
                            <option value="bug">问题报告</option>
                            <option value="compliment">表扬鼓励</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackTitle">标题</label>
                        <input type="text" id="feedbackTitle" required placeholder="请输入反馈标题">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackContent">详细内容</label>
                        <textarea id="feedbackContent" rows="5" required placeholder="请详细描述您的反馈内容..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackContact">联系方式（可选）</label>
                        <input type="text" id="feedbackContact" placeholder="邮箱或手机号，方便我们联系您">
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox">
                            <input type="checkbox" required> 我已阅读并同意<a href="#">隐私政策</a>
                        </label>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('feedbackModal')">取消</button>
                        <button type="submit" class="btn btn-primary">提交反馈</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- JavaScript引用 -->
    <!-- 核心脚本同步加载 -->
    <script src="js/utils.js"></script>
    <script src="js/config.js"></script>
    <script src="js/modules/CoreFramework.js"></script>
    <script src="js/app.js"></script>
    
    <!-- 其他脚本延迟加载 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.1/dist/umd/supabase.min.js" defer></script>
    <script src="js/modules/ModalSystem.js" defer></script>
    <script src="js/modules/ThemeSystem.js" defer></script>
    <script src="js/modules/NavigationSystem.js" defer></script>
    <script src="js/modules/NotificationSystem.js" defer></script>
    <script src="js/modules/UserManagement.js" defer></script>
    <script src="js/modules/MembershipSystem.js" defer></script>
    <script src="js/modules/BrowserSystem.js" defer></script>
    <script src="js/modules/ResourceManager.js" defer></script>
    <script src="js/modules/ResourceCenter.js" defer></script>
    <script src="js/modules/ToolManager.js" defer></script>
    <script src="js/modules/CommentSystem.js" defer></script>
    <script src="js/modules/CategoryTagManager.js" defer></script>
    <script src="js/modules/DownloadManager.js" defer></script>
    <script src="js/modules/PointSystem.js" defer></script>
    <script src="js/modules/SearchSystem.js" defer></script>
    
    <!-- 未登录状态修复脚本 -->
    <script>
        // 页面完全加载后执行修复逻辑
        window.addEventListener('load', function() {
            // 确保在所有模块加载完成后执行
            setTimeout(function() {
                try {
                    // 清除localStorage中的用户信息（确保未登录状态）
                    localStorage.removeItem('currentUser');
                    
                    // 如果userManagement模块存在，强制设置为未登录状态并更新UI
                    if (typeof window.userManagement !== 'undefined') {
                        window.userManagement.currentUser = null;
                        window.userManagement.updateUserInterface();
                        console.log('已强制设置为未登录状态并更新UI');
                    } else {
                        console.warn('userManagement模块未加载，使用DOM直接修复');
                        // 直接操作DOM修复
                        const userProfile = document.getElementById('userProfile');
                        const loginElements = document.querySelectorAll('.navbar-buttons button');
                        
                        if (userProfile) {
                            userProfile.style.display = 'none';
                            console.log('已隐藏用户资料');
                        }
                        
                        if (loginElements) {
                            loginElements.forEach(button => {
                                button.style.display = 'block';
                            });
                            console.log('已显示登录/注册按钮');
                        }
                    }
                } catch (error) {
                    console.error('未登录状态修复失败:', error);
                }
            }, 1000); // 1秒延迟确保所有模块加载完成
        });
        
        // 直接在HTML中定义openFeedbackModal函数，确保它总是可用
        window.openFeedbackModal = function() {
            console.log('HTML内联脚本: openFeedbackModal被调用');
            
            // 尝试多种方式打开反馈模态框
            if (window.modalSystem && window.modalSystem.openModal) {
                console.log('HTML内联脚本: 使用window.modalSystem.openModal');
                window.modalSystem.openModal('feedbackModal');
            } else if (window.openModal) {
                console.log('HTML内联脚本: 使用window.openModal');
                window.openModal('feedbackModal');
            } else {
                console.log('HTML内联脚本: 直接操作DOM显示模态框');
                const feedbackModal = document.getElementById('feedbackModal');
                if (feedbackModal) {
                    feedbackModal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                } else {
                    console.error('HTML内联脚本: 无法找到feedbackModal元素');
                }
            }
        };
        
        console.log('HTML内联脚本: openFeedbackModal函数已定义:', typeof window.openFeedbackModal);
    </script>
    
    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="logo">
                        <i class="fas fa-tools logo-icon"></i>
                        <span class="logo-text">智能工具中心</span>
                    </div>
                    <p class="footer-description">
                        一站式在线工具平台，为用户提供丰富、高效的工具服务
                    </p>
                    <div class="footer-social">
                        <a href="#" class="social-link" aria-label="微信">
                            <i class="fab fa-weixin"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="微博">
                            <i class="fab fa-weibo"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="GitHub">
                            <i class="fab fa-github"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h4>快速导航</h4>
                    <ul>
                        <li><a href="#tools">工具库</a></li>
                        <li><a href="#membership">会员中心</a></li>
                        <li><a href="#about">关于我们</a></li>
                        <li><a href="#userCenter">个人中心</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h4>关于我们</h4>
                    <ul>
                        <li><a href="#">网站介绍</a></li>
                        <li><a href="#">团队成员</a></li>
                        <li><a href="#">联系我们</a></li>
                        <li><a href="#">加入我们</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h4>帮助中心</h4>
                    <ul>
                        <li><a href="#">使用指南</a></li>
                        <li><a href="#">常见问题</a></li>
                        <li><a href="#">用户协议</a></li>
                        <li><a href="#">隐私政策</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-copyright">
                    <p>&copy; 2025 智能工具中心. 保留所有权利.</p>
                </div>
                <div class="footer-feedback">
                    <button class="btn btn-outline-light btn-sm" onclick="window.openFeedbackModal()">
                        <i class="fas fa-comment-dots"></i> 用户反馈
                    </button>
                    <!-- 调试按钮 -->
                    <button class="btn btn-outline-warning btn-sm" onclick="console.log('调试: openFeedbackModal:', typeof openFeedbackModal, openFeedbackModal);">
                        <i class="fas fa-bug"></i> 调试
                    </button>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>